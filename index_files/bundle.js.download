/*!

Polarr.co Copyright 2019-12-11. All rights reserved.

No part of the materials including graphics, logos, designs, codes,
available in this Web site may be copied, photocopied, reproduced, translated or
reduced to any electronic medium or machine-readable form, in whole or in part,
without specific permission. Distribution for commercial purposes is prohibited.

 ...............................................................................
................................................................................
.......................................M........................................
.......................................M........................................
.......................................M........................................
...............  .. .......... ........M......   .  .........   ...  ...........
............MM ... MN .....MM....MM ...M... MM....OM..... :M?...MM..............
.......... M........,M ..DM .......M ..M.. M........MM...M7....M................
..........M..........MD. M..........M..M..M .........M.. M....M:..... ... ... ..
..........M ......... M. M..........M..M. M .........$M.M.....M.................
..........M..........M8. M..........M..M..M .........MM.M.....M.................
..........MM........ M...NM,.......M ..M.. M........NMM.M.....M.................
..........M.NM....~MZ......MM ...MM ...M....MM.. .8M $M.M.....M.................
..........M...... ...........  ................,  ......  ......................
..........M.....................................................................
..........M.....................................................................
.. .......M.......................................................... ... ... ..
................................................................................

polarr_homepage_v1 2019-12-11

*/

this.polarr_homepage_templates=this.polarr_homepage_templates||{},this.polarr_homepage_templates["public_src/src/pug/module_filter_details"]=function(e){var i,a="",t=e||{};return function(e,t,l,s,d,r,o,c,p){a=a+'<div class="module_filter_details"><div class="qr_code_wrapper"></div><div class="filter_detail"><div class="filter_name">'+pug.escape(null==(i=s)?"":i)+'</div><div class="filter_description">Created by '+pug.escape(null==(i=p)?"":i)+". "+pug.escape(null==(i=t)?"":i)+'</div></div><div class="style_look"><div class="style_look_before"><div class="text_before">BEFORE</div><div class="text_after">AFTER</div></div><canvas class="style_look_after"></canvas>',"mine"==e?c==d&&(a=1==l?a+'<div class="status">Public, '+pug.escape(null==(i=r)?"":i)+" scans</div>":a+'<div class="status">Unlisted, '+pug.escape(null==(i=r)?"":i)+" scans</div>"):a=a+'<div class="status">'+pug.escape(null==(i=r)?"":i)+" scans</div>","mine"==e?(a+='<div class="actions"><div class="button delete_filter">Remove</div>',c==d&&(a+='<div class="button edit_filter">Modify</div>'),a+="</div>"):(a+='<div class="filter_tags">',function(){var e=o.split(",");if("number"==typeof e.length)for(var t=0,l=e.length;t<l;t++){var s=e[t];a=a+'<a class="tag"'+pug.attr("href","/filters/search/"+s,!0,!1)+">#"+pug.escape(null==(i=s)?"":i)+"</a>"}else{l=0;for(var t in e){l++;s=e[t];a=a+'<a class="tag"'+pug.attr("href","/filters/search/"+s,!0,!1)+">#"+pug.escape(null==(i=s)?"":i)+"</a>"}}}.call(this),a+="</div>"),a+="</div></div>"}.call(this,"cur_panel"in t?t.cur_panel:"undefined"!=typeof cur_panel?cur_panel:void 0,"filter_description"in t?t.filter_description:"undefined"!=typeof filter_description?filter_description:void 0,"filter_is_public"in t?t.filter_is_public:"undefined"!=typeof filter_is_public?filter_is_public:void 0,"filter_name"in t?t.filter_name:"undefined"!=typeof filter_name?filter_name:void 0,"filter_owner_user_id"in t?t.filter_owner_user_id:"undefined"!=typeof filter_owner_user_id?filter_owner_user_id:void 0,"filter_scan_count"in t?t.filter_scan_count:"undefined"!=typeof filter_scan_count?filter_scan_count:void 0,"filter_tags"in t?t.filter_tags:"undefined"!=typeof filter_tags?filter_tags:void 0,"filter_user_id"in t?t.filter_user_id:"undefined"!=typeof filter_user_id?filter_user_id:void 0,"filter_user_name"in t?t.filter_user_name:"undefined"!=typeof filter_user_name?filter_user_name:void 0),a},this.polarr_homepage_templates["public_src/src/pug/module_popup"]=function(e){var i,a="",t=e||{};return function(e,t,l,s,d,r,o,c){a=a+"<div"+pug.attr("class",pug.classes(["module_popup","hide_"+t],[!1,!0]),!1,!1)+'><div class="table"><div class="table_cell"><div class="form">',"subscribe"==r?a+='<div class="form_inner"><div class="title">placeholder</div><div class="input email"><input placeholder="placeholder" type="email"/></div><div class="subtitle">placeholder</div></div><div class="error"></div><div class="form_action">placeholder</div>':"rules"==r?a+='<div class="form_inner"><div class="title">placeholder</div><ul><li>placeholder <a href="mailto:support@polarr.co">support@polarr.co</a>。</li></ul></div><div class="form_action">placeholder</div>':"edit_filter"==r?a=a+'<div class="form_inner"><div class="title">Modify Filter</div><div class="subtitle">Change filter name, description and search tags. Are fields are mandatory.</div><div class="input name"><div class="character_counter">Filter name</div><input placeholder="Name of this filter" type="text"'+pug.attr("value",d.name,!0,!1)+'/></div><div class="input tags"><div class="character_counter">Filter search tags</div><input placeholder="Seperated by comma" type="text"'+pug.attr("value",d.tags,!0,!1)+'/></div><div class="input demo_image"><div class="character_counter">Filter demo image</div><input placeholder="Must be an URL" type="text"'+pug.attr("value",d.demo_image,!0,!1)+'/></div><div class="input description"><div class="character_counter">Filter description</div><textarea placeholder="Description: A short description of your filter and its main use cases." type="text">'+pug.escape(null==(i=d.description)?"":i)+'</textarea></div><div class="input is_public"><div class="character_counter">Allow public search</div><input type="checkbox"'+pug.attr("checked",e(d.is_public),!0,!1)+'/></div></div><div class="error"></div><div class="form_action">Submit\t\t</div>':"qr"==r?a+='<div class="form_inner"><div class="title">Scan / Download QR</div><div class="subtitle">Scan or download to use in <a href="http://www.polarr.co" target="_blank">Polarr</a> (<a href="https://www.polarr.co/wiki/product-features/Custom-filters.html" target="_blank">guide</a>).</div><div class="qr"></div></div><div class="form_action">Download</div>':"login"==r?(a+='<div class="form_switch">',a+=s?'<div class="switch active" is_signup="1">Sign Up</div><div class="switch" is_signup="0">Sign In</div>':'<div class="switch" is_signup="1">Sign Up</div><div class="switch active" is_signup="0">Sign In</div>',a+='</div><div class="form_inner">',s?a+='<div class="title">Create Polarr account</div><div class="input email"><input placeholder="Email" type="email"/></div><div class="input password"><input placeholder="Password" type="password"/></div><div class="input user_name"><input placeholder="Username"/></div>':(a+='<div class="title">Sign In Polarr account</div><div class="input email"><input placeholder="Email" type="email"/></div>',l||(a+='<div class="input password"><input placeholder="Password" type="password"/></div><div class="input forgot_password"><div class="a">Forgot password?</div></div>')),a+='<div class="subtitle">Your account can be used for Polarr Photo Editor as well as Polarr community features.</div></div><div class="error"></div>',a+=s?'<div class="form_action">Sign Up</div>':l?'<div class="form_action">Send password link.</div>':'<div class="form_action">Sign In</div>'):"submit"==r&&(a=a+'<div class="form_inner"><div class="title">placeholder</div><div class="input location"><input placeholder="placeholder" type="text"/></div><div class="input gears"><input placeholder="placeholder" type="text"'+pug.attr("value",c.gears,!0,!1)+'/></div><div class="input author"><input placeholder="placeholder" type="text"'+pug.attr("value",c.author,!0,!1)+'/></div><div class="input contact"><input placeholder="placeholder" type="text"'+pug.attr("value",c.contact,!0,!1)+'/></div><div class="input tags"><input placeholder="placeholder" type="text"/><div class="more_info" onclick="alert(&quot;placeholder&quot;)">?</div></div><div class="input story"><div class="character_counter"></div><textarea placeholder="placeholder" type="text"></textarea></div><div class="input avatar file"><div class="background_placeholder"'+pug.attr("style",pug.style("background-image:url("+o+")"),!0,!1)+'></div><div class="text">placeholder</div><input type="file"/></div><div class="input photo file"><div class="text">placeholder</div><input type="file"/></div><div class="subtitle">placeholder</div></div><div class="form_action">placeholder</div>'),a+="</div></div></div></div>"}.call(this,"Boolean"in t?t.Boolean:"undefined"!=typeof Boolean?Boolean:void 0,"hide_on_start"in t?t.hide_on_start:"undefined"!=typeof hide_on_start?hide_on_start:void 0,"is_forgot_password"in t?t.is_forgot_password:"undefined"!=typeof is_forgot_password?is_forgot_password:void 0,"is_signup"in t?t.is_signup:"undefined"!=typeof is_signup?is_signup:void 0,"placeholder"in t?t.placeholder:"undefined"!=typeof placeholder?placeholder:void 0,"popup_type"in t?t.popup_type:"undefined"!=typeof popup_type?popup_type:void 0,"user_avatar_placeholder"in t?t.user_avatar_placeholder:"undefined"!=typeof user_avatar_placeholder?user_avatar_placeholder:void 0,"user_metadata_placeholder"in t?t.user_metadata_placeholder:"undefined"!=typeof user_metadata_placeholder?user_metadata_placeholder:void 0),a},this.polarr_homepage_templates["public_src/src/pug/page_palette_intro"]=function(e){var i="";return i+='<div class="page_palette_intro">page_palette_intro</div>'},this.polarr_homepage_templates["public_src/src/pug/page_palette"]=function(e){var i="";return i+='<div class="page_palette">page_palette</div>'};
/*!

Polarr.co Copyright 2019-12-11. All rights reserved.

No part of the materials including graphics, logos, designs, codes,
available in this Web site may be copied, photocopied, reproduced, translated or
reduced to any electronic medium or machine-readable form, in whole or in part,
without specific permission. Distribution for commercial purposes is prohibited.

 ...............................................................................
................................................................................
.......................................M........................................
.......................................M........................................
.......................................M........................................
...............  .. .......... ........M......   .  .........   ...  ...........
............MM ... MN .....MM....MM ...M... MM....OM..... :M?...MM..............
.......... M........,M ..DM .......M ..M.. M........MM...M7....M................
..........M..........MD. M..........M..M..M .........M.. M....M:..... ... ... ..
..........M ......... M. M..........M..M. M .........$M.M.....M.................
..........M..........M8. M..........M..M..M .........MM.M.....M.................
..........MM........ M...NM,.......M ..M.. M........NMM.M.....M.................
..........M.NM....~MZ......MM ...MM ...M....MM.. .8M $M.M.....M.................
..........M...... ...........  ................,  ......  ......................
..........M.....................................................................
..........M.....................................................................
.. .......M.......................................................... ... ... ..
................................................................................

polarr_homepage_v1 2019-12-11

*/

var HOME,MD,UI,WS,err;(HOME=HOME||{}).lang=(window.navigator.userLanguage||window.navigator.language).toLowerCase(),HOME.kloudless_research_upload_credentials={s3_root:"https://s3-us-west-2.amazonaws.com/polarrtest2/research/",url:"https://api.kloudless.com/v0/accounts/15763/files/?overwrite=true",account_id:15763,parent_id:"fcG9sYXJydGVzdDIvcmVzZWFyY2gv",account_key:"Z3GK87_spTFQgHOh7b6_FyewDu3jrVvrtR0NyZroy0wsn_mW"},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},HOME.version="1.0",HOME.global_tmp={},HOME.polarr_store=localStorage,MD=class{set_item(e,t){return HOME.polarr_store.setItem(e,t)}get_item(e,t){return HOME.polarr_store.getItem(e)||""}},UI=function(){class e{constructor(){this.loadScript=this.loadScript.bind(this)}highlight(e){var t,r;(t=document.createRange()).selectNodeContents(e),(r=window.getSelection()).removeAllRanges(),r.addRange(t)}is_browser_unsupported(){var e;return HOME.mobile_check=function(){var e;return e=!1,navigator.userAgent||navigator.vendor||window.opera,/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(e=!0),e},HOME.is_mobile=HOME.mobile_check(),HOME.is_chrome=/chrom(e|ium)/.test(navigator.userAgent.toLowerCase()),HOME.is_safari=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor),HOME.is_firefox="undefined"!=typeof InstallTrigger,HOME.is_ie11=!!navigator.userAgent.match(/Trident.*rv[ :]*11\./),HOME.is_edge=/Edge\/12./i.test(navigator.userAgent),HOME.is_OSX=!!navigator.platform.match(/(Mac)/i),HOME.is_linux=!!navigator.platform.match(/(Linux)/i),HOME.is_iOS=!!navigator.platform.match(/(iPhone|iPod|iPad)/i),HOME.is_Mac=navigator.platform.toUpperCase().indexOf("MAC")>=0,HOME.is_iPhone="iPhone"===navigator.platform,HOME.is_iPod="iPod"===navigator.platform,HOME.is_iPad="iPad"===navigator.platform,HOME.is_windows_desktop=!(HOME.is_OSX||HOME.is_linux||HOME.is_Mac||HOME.is_iOS||HOME.is_mobile),HOME.missing_web_gl=!function(){var e;try{return e=document.createElement("canvas"),!!window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch(e){return e,!1}}(),e=!HOME.is_ie11&&!HOME.is_chrome&&!HOME.is_safari&&!HOME.is_firefox||HOME.missing_web_gl,HOME.is_mobile&&(e=!1),window.force_browser_support||"1"===HOME.ui.url_params("force_browser_support")?e=!1:e}clone_canvas(e){var t,r;return t=(r=document.createElement("canvas")).getContext("2d"),r.width=e.width,r.height=e.height,t.drawImage(e,0,0),r}url_params(e){var t;return e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),null==(t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search))?"":decodeURIComponent(t[1].replace(/\+/g," "))}find_dom_color(e,t,r){var a,n;return n=this,(a=document.createElement("img")).src=e,a.onload=function(){var e,i,o,s,l,c,d,u,h;for(e=t.block_size||5,n.dom_color_canvas||(n.dom_color_canvas=document.createElement("canvas")),i=n.dom_color_canvas.getContext("2d"),c=-4,u={r:0,g:0,b:0},o=0,l=n.dom_color_canvas.height=a.height,h=n.dom_color_canvas.width=a.width,i.drawImage(a,0,0),d=(s=i.getImageData(0,0,h,l)).data.length;c<d-4;)c+=4*e,o+=1,u.r+=s.data[c],u.g+=s.data[c+1],u.b+=s.data[c+2];if(u.r=~~(u.r/o),u.g=~~(u.g/o),u.b=~~(u.b/o),t.return_hex){if(r)return r(n.rgb_to_hex(u),t)}else if(r)return r(u,t)}}is_scroll_into_view(e,t){var r,a,n;return!(!e||null==$(e).offset())&&(r=(a=$(window).scrollTop())+$(window).height()+(t||0),(n=$(e).offset().top)+$(e).height()<=r&&n>=a)}blink(e){var t;return t=this.title,this.blink_interval=setInterval(function(){return-1===document.title.indexOf(e)?document.title=e+" "+t:document.title=t},500)}unblink(){return clearInterval(this.blink_interval),document.title=this.title}enhtml(e){return $("<div/>").text(e).html()}dehtml(e){return $("<div/>").html(value).text()}toint(e){var t;return t=e.match(/\d+/),parseInt(t[0],10)}keyenter(e,t){return $(`#${e}`).unbind().keypress(e=>{if(13===(e.keyCode||e.which))return t(),!1})}schedule(e){return setTimeout(e,0)}render(e,t,r,a,n){var i;return e instanceof Array&&(e=e[0]),e||(e=$(this.container)),e="string"==typeof e?"#"===e[0]||"."===e[0]?$(e):$("#"+e):$(e),r||(r={}),r._mixins=this._mixins,r._helpers=this._helpers,i=$(polarr_homepage_templates[`public_src/src/pug/${t}`](r)),a?e.html(i):e.append(i),"function"==typeof n&&this.schedule(()=>n(i,e)),$(function(){var e;return e=/INPUT|SELECT|TEXTAREA/i,$(document).unbind("keydown keypress").bind("keydown keypress",function(t){if(8===t.which){if("range"===t.target.type||"color"===t.target.type)return t.preventDefault();if(("inherit"===t.target.contentEditable||void 0===t.target.contentEditable||!1===t.target.contentEditable)&&(!e.test(t.target.tagName)||t.target.disabled||t.target.readOnly))return t.preventDefault()}})})}slug(e){return e.toLowerCase().replace(/\s/g,"_").replace(/[^\w-]+/g,"")}loadScript(e,t,r){var a;(a=document.createElement("script")).src=e,a.async=!1,a.onload=t,a.onerror=r,document.head.appendChild(a)}qr_code(e,t,r=100){var a;return(a=new QRCode(e,{width:r,height:r,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H})).clear(),a.makeCode(t)}color_similarty(e,t){return this.deltaE2000(this.rgb_to_lab(e),this.rgb_to_lab(t))}genid(e){return Math.random().toString(36).substring(e||7)}rgb_to_hex(e){var t;return"#"+(t=function(e){var t;return 1===(t=e.toString(16)).length?"0"+t:t})(e.r)+t(e.g)+t(e.b)}rgb_to_lab(e){var t,r,a,n,i,o,s,l,c;return i=parseInt(e.substring(1,3),16)/255,a=parseInt(e.substring(3,5),16)/255,r=parseInt(e.substring(5,7),16)/255,i>.04045?i=((i+.055)/1.055)**2.4:i/=12.92,a>.04045?a=((a+.055)/1.055)**2.4:a/=12.92,r>.04045?r=((r+.055)/1.055)**2.4:r/=12.92,(s={x:0,y:0,z:0}).x=.4124*(i*=100)+.3576*(a*=100)+.1805*(r*=100),s.y=.2126*i+.7152*a+.0722*r,s.z=.0193*i+.1192*a+.9505*r,t=s.x,95.047,100,108.883,l=s.y/100,c=s.z/108.883,o=(o=t/95.047)>.008856?o**(1/3):7.787*o+16/116,l=l>.008856?l**(1/3):7.787*l+16/116,c=c>.008856?c**(1/3):7.787*c+16/116,(n={l:0,a:0,b:0}).l=116*l-16,n.a=500*(o-l),n.b=200*(l-c),n}deltaE2000(e,t){var r,a,n,i,o,s,l,c,d,u,h,p,_,g,m,f,w,v,M,E,b,O,y;return 1,1,1,v=.5*(e.l+t.l),s=(o=.5*(Math.sqrt(e.a*e.a+e.b*e.b)+Math.sqrt(t.a*t.a+t.b*t.b)))*o*o*o*o*o*o,g=.5*(1-Math.sqrt(s/(s+6103515625))),r=e.a*(1+g),a=t.a*(1+g),l=.5*((n=Math.sqrt(r*r+e.b*e.b))+(i=Math.sqrt(a*a+t.b*t.b))),(m=180*Math.atan2(e.b,r)/Math.PI)<0&&(m+=360),(f=180*Math.atan2(t.b,a)/Math.PI)<0&&(f+=360),w=Math.abs(m-f)>180?.5*(m+f+360):.5*(m+f),y=1-.17*Math.cos(Math.PI*(w-30)/180)+.24*Math.cos(2*Math.PI*w/180)+.32*Math.cos(Math.PI*(3*w+6)/180)-.2*Math.cos(Math.PI*(4*w-63)/180),_=Math.abs(f-m)<=180?f-m:f<=m?f-m+360:f-m-360,h=t.l-e.l,d=i-n,u=2*Math.sqrt(n*i)*Math.sin(.5*Math.PI*_/180),O=1+.015*(v-50)*(v-50)/Math.sqrt(20+(v-50)*(v-50)),E=1+.045*l,b=1+.015*l*y,p=30*Math.exp(-(w-275)/25*(w-275)/25),c=l*l*l*l*l*l*l,M=-2*Math.sqrt(c/(c+6103515625))*Math.sin(2*Math.PI*p/180),Math.sqrt(h/(1*O)*h/(1*O)+d/(1*E)*d/(1*E)+u/(1*b)*u/(1*b)+d/(1*E)*u/(1*b)*M)}}return e.prototype.container="#polarr_wrapper",e.prototype.blink_interval=null,e.prototype.title=document.title,e.prototype._mixins={dummy:""},e.prototype._helpers={printobject:function(e){var t,r,a;for(t in a="",r=JSON.parse(e))a+=`<strong>${t}</strong>: <span style='min-width: 60px; display: inline-block'>${r[t]}</span>`;return a},timeago:function(e){return $.timeago(e.split(".")[0]+"Z")}},e}.call(this),WS=function(){class e{share_to_facebook(e,t){return this,window.open("http://www.facebook.com/sharer.php?s=100&p[title]="+t+"&p[url]="+e,"sharer","top=0,left=0,toolbar=0,status=0,width=500,height=300")}share_to_twitter(e,t){return this,window.open("https://twitter.com/share?url="+e+"&text="+t)}dataURItoBlob(e){var t,r,a,n;for(t=void 0,t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],a=new Uint8Array(t.length),r=0;r<t.length;)a[r]=t.charCodeAt(r),r++;return new Blob([a],{type:n})}upload_s3_image(e,t,r,a,n,i){var o,s,l,c,d,u;return this,u=0,d=0,c=function(e,t,o){var s;return s=new FormData,null!=i?s.append("metadata",JSON.stringify({name:i(o),parent_id:n.parent_id})):s.append("metadata",JSON.stringify({name:`${HOME.md.get_item("user_name").split("@")[0]}_img_`+HOME.ui.genid()+".jpg",parent_id:n.parent_id})),s.append("parent_id",n.parent_id),s.append("file",HOME.ws.dataURItoBlob(e)),$.ajax({url:n.url,type:"POST",data:s,processData:!1,contentType:!1,cache:!1,beforeSend:function(e){return e.setRequestHeader("Authorization",`AccountKey ${n.account_key}`)},success:function(e){return null!=r&&r.dismiss(),null!=t?t(n.s3_root+e.name):null!=a?a(n.s3_root+e.name):void 0},error:function(e,t,r){},complete:function(){}})},e&&"string"==typeof e&&$(document).find(e)[0].addEventListener("change",function(e){var n;if(d=0,u=e.target.files.length)return(n=(i=>{var o;return(o=document.createElement("img")).src=URL.createObjectURL(i),o.onload=function(){var s,l;return(s=document.createElement("canvas")).width=t,s.height=parseInt(s.width*o.height/o.width),s.getContext("2d").drawImage(o,0,0,s.width,s.height),l=s.toDataURL("image/jpeg",.85),null!=r&&r.show_message(HOME.i18n.g("d46"),1e4),c(l,t=>{if(a(t,d+=1,u),d<u)return n(e.target.files[d])},i.name)}}))(e.target.files[d])},!1),e&&"object"==typeof e&&""!==e.src?((o=document.createElement("canvas")).width=t,o.height=parseInt(o.width*e.height/e.width),o.getContext("2d").drawImage(e,0,0,o.width,o.height),s=o.toDataURL("image/jpeg",.85),null!=r&&r.show_message(HOME.i18n.g("d46"),1e4),c(s)):e&&"object"==typeof e?((l=document.createElement("img")).src=e.toDataURL("image/jpeg",.9),l.onload=function(){return(o=document.createElement("canvas")).width=t,o.height=parseInt(o.width*l.height/l.width),o.getContext("2d").drawImage(l,0,0,o.width,o.height),s=o.toDataURL("image/jpeg",.85),null!=r&&r.show_message(HOME.i18n.g("d46"),1e4),c(s)}):void 0}cachewrite(e,t,r,a){if(this.ajax_cache[e+"_"+t]={data:JSON.parse(JSON.stringify(r)),time:new Date,duration:this.ajax_cache_default_expire},null!=a)return this.ajax_cache[e+"_"+t].duration=a}cacheread(e,t){return null!=this.ajax_cache[e+"_"+t]&&(new Date-this.ajax_cache[e+"_"+t].time>this.ajax_cache[e+"_"+t].duration?(delete this.ajax_cache[e+"_"+t],!1):JSON.parse(JSON.stringify(this.ajax_cache[e+"_"+t].data)))}rooturl(){return location.href.indexOf("localhost")>0?"http://"+location.href.split("//")[1].split("/")[0]:"https://www.polarr.co"}request(e,t,r,a,n,i,o){var s,l;return e=e.toUpperCase(),HOME.chrome_app&&(o=!0),"undefined"==typeof NProgress||null===NProgress||o||NProgress.start(),l=this,r||(r={}),r.user_id=r.user_id||HOME.md.get_item("user_id"),r.access_token=r.access_token||HOME.md.get_item("access_token"),r.session_token=r.session_token||HOME.md.get_item("session_token"),r.user_id||(r.user_id=void 0),r.access_token||(r.access_token=void 0),r.session_token||(r.session_token=void 0),l.clear_data(r),!1!==(s=l.cacheread(t,t))?("undefined"==typeof NProgress||null===NProgress||o||NProgress.done(),void a(s)):$.ajax({type:e,url:t.match("http")?t:l.rooturl()+"/"+t,dataType:"json",timeout:8e3,data:JSON.stringify(r),contentType:"application/json",success:function(r){return"GET"===e?l.cachewrite(t,t,r,i):"undefined"!=typeof duration&&null!==duration&&l.cachewrite(t,t,r,i),"undefined"==typeof NProgress||null===NProgress||o||NProgress.done(),"error"===r.status||r.err?n?n(r.err):a(r):(r.data&&null!=r.data.session_token&&HOME.md.set_item("session_token",r.data.session_token),r.data&&null!=r.data.access_token&&HOME.md.set_item("access_token",r.data.access_token),r.data&&null!=r.data.user_id&&HOME.md.set_item("user_id",r.data.user_id),r.data&&null!=r.data.user_name&&HOME.md.set_item("user_name",r.data.user_name),a(r))},error:function(e,t,r){"undefined"==typeof NProgress||null===NProgress||o||NProgress.done()}})}clear_data(e){var t,r,a,n,i,o;for(r in i=[],e){for(a in o=e[r],"_"===r[0]&&delete e[r],o)o[a],"_"===a[0]&&delete o[a];null!=o?i.push(function(){var e,r,a;for(a=[],e=0,r=o.length;e<r;e++)t=o[e],a.push(function(){var e;for(n in e=[],t)t[n],"_"===n[0]?e.push(delete t[n]):e.push(void 0);return e}());return a}()):i.push(void 0)}return i}}return e.prototype.ajax_cache_default_expire=3e3,e.prototype.ajax_cache={},e.prototype.facebook_auth=null,e}.call(this),HOME.ui=new UI,HOME.ws=new WS;try{HOME.md=new MD}catch(e){err=e}
/*!

Polarr.co Copyright 2019-12-11. All rights reserved.

No part of the materials including graphics, logos, designs, codes,
available in this Web site may be copied, photocopied, reproduced, translated or
reduced to any electronic medium or machine-readable form, in whole or in part,
without specific permission. Distribution for commercial purposes is prohibited.

 ...............................................................................
................................................................................
.......................................M........................................
.......................................M........................................
.......................................M........................................
...............  .. .......... ........M......   .  .........   ...  ...........
............MM ... MN .....MM....MM ...M... MM....OM..... :M?...MM..............
.......... M........,M ..DM .......M ..M.. M........MM...M7....M................
..........M..........MD. M..........M..M..M .........M.. M....M:..... ... ... ..
..........M ......... M. M..........M..M. M .........$M.M.....M.................
..........M..........M8. M..........M..M..M .........MM.M.....M.................
..........MM........ M...NM,.......M ..M.. M........NMM.M.....M.................
..........M.NM....~MZ......MM ...MM ...M....MM.. .8M $M.M.....M.................
..........M...... ...........  ................,  ......  ......................
..........M.....................................................................
..........M.....................................................................
.. .......M.......................................................... ... ... ..
................................................................................

polarr_homepage_v1 2019-12-11

*/

var MODULE_FILTER_DETAILS,MODULE_POPUP,UTIL,VIEWER,load_lens_comparison,PAGE_PALETTE_INTRO,PAGE_PALETTE;MODULE_FILTER_DETAILS=class{constructor(t){this.render=this.render.bind(this),this.render_before_after=this.render_before_after.bind(this),this.load=this.load.bind(this),t=t||{},({target:this.target,filter:this.filter,cur_panel:this.cur_panel,next:this.next,delete:this.delete}=t),this.parent,this.target_canvas,this.default_demo_image="https://i.imgur.com/TpDDzl4.jpg",this.filter_content=JSON.parse(this.filter.filter_content),this.filter_name=decodeURI(this.filter_content.name||""),this.filter_user_name=this.filter.user_name,this.filter_demo_image=decodeURI(this.filter_content.demo_image||this.default_demo_image),this.filter_description=decodeURI(this.filter_content.description||""),this.filter_tags=this.filter.tags,this.filter_scan_count=this.filter.scan_count,this.filter_user_id=this.filter.User_id,this.filter_owner_user_id=this.filter.Owner_user_id,this.filter_is_public=this.filter.public,this.render()}destroy(){return this.parent.parent().remove()}render(){return HOME.ui.render(this.target,"module_filter_details",this,!0,t=>(this.parent=t,this.target_canvas=this.parent.find("canvas")[0],this.image_before=this.parent.find(".style_look_before")[0],this.image_before.style.marginLeft="-"+$(this.image_before).parent().width()/2+"px",this.image_before.style.backgroundPosition=$(this.image_before).parent().width()/2+"px 50%",this.load()))}render_before_after(t,e){return Filtr.import(t,{done:()=>{var i,r,s,n;return s=(n=Filtr.getInfo()).width,r=n.height,Filtr.resize(s,r),this.target_canvas.width=s,this.target_canvas.height=r,this.image_before.style.backgroundImage=`url(${t})`,(i=this.target_canvas.getContext("2d").createImageData(s,r)).data.set(Filtr.export("data",{settings:this.filter_content.state}).data),this.target_canvas.getContext("2d").putImageData(i,0,0),e()},error:()=>setTimeout(()=>this.render_before_after(this.default_demo_image,e))})}load(){return this.render_before_after(this.filter_demo_image,()=>{var t;return this.parent.find(".style_look").unbind().on("mousemove touchmove",t=>{var e;return e=$(t.target).width()-(t.pageX||t.originalEvent.touches[0].pageX)+$(t.target).offset().left,this.image_before.style.marginLeft="-"+e+"px",this.image_before.style.backgroundPosition=e+"px 50%"}),this.parent.find(".delete_filter").unbind().click(()=>{if(confirm(`Are you sure to remove filter: ${this.filter_name}, this filter will be removed from all your devices.`))return HOME.ws.request("POST","users/delete_custom_filter",{filter_id:this.filter.id},()=>(alert("Filter removed"),this.delete(),this.destroy()))}),this.parent.find(".edit_filter").unbind().click(()=>this.edit_filter_popup=new MODULE_POPUP({target:".user_auth",popup_type:"edit_filter",placeholder:{tags:this.filter_tags,description:this.filter_description,name:this.filter_name,demo_image:this.filter_demo_image,is_public:this.filter_is_public},submit_callback:t=>(this.filter_content.description=t.description,this.filter_content.name=t.name,this.filter_content.demo_image=t.demo_image,this.filter_tags=t.tags,this.filter_is_public=Number(t.is_public),this.filter_name=this.filter_content.name,this.filter_demo_image=this.filter_content.demo_image,this.filter_description=this.filter_content.description,HOME.ws.request("POST","users/modify_owner_custom_filter",{filter_content:JSON.stringify(this.filter_content),tags:this.filter_tags,public:this.filter_is_public,filter_id:this.filter.User_custom_filter_id,timestamp:new Date},()=>(alert("Filter updated"),this.render(),this.edit_filter_popup.hide())))})),t=`https://www.polarr.co/users/custom_filter/${this.filter.id}`,HOME.ui.qr_code(this.parent.find(".qr_code_wrapper")[0],t),setTimeout(()=>(this.parent.find(".qr_code_wrapper").css("opacity",1),this.parent.find(".qr_code_wrapper").click(()=>this.qr_popup=new MODULE_POPUP({target:".user_auth",popup_type:"qr",hide_on_start:!1,placeholder:{qr_url:t}})))),this.next()})}},MODULE_POPUP=class{constructor(t){this.render=this.render.bind(this),this.extract_photo=this.extract_photo.bind(this),this.submit_photo=this.submit_photo.bind(this),this.register=this.register.bind(this),this.add_subscriber=this.add_subscriber.bind(this),this.reset_password=this.reset_password.bind(this),this.login_manual=this.login_manual.bind(this),this.login_auto=this.login_auto.bind(this),this.check=this.check.bind(this),this.hide=this.hide.bind(this),this.show=this.show.bind(this),t=t||{},({target:this.target,hide_on_start:this.hide_on_start,popup_type:this.popup_type,iso_requirement:this.iso_requirement,submit_callback:this.submit_callback,placeholder:this.placeholder}=t),this.parent,this.placeholder=this.placeholder||{},this.is_signup=!1,this.user_signed_in=!1,this.user_id=HOME.md.get_item("user_id"),this.user_name=HOME.md.get_item("user_name"),this.user_avatar_placeholder=HOME.md.get_item("profile_picture_url"),this.user_metadata_placeholder=JSON.parse(HOME.md.get_item("metadata")||"{}"),this.file_submit_thumbnail,this.file_submit_photo,this.file_submit_photo_exif={},this.file_submit_avatar,this.file_submit_avatar_exif={},this.file_submit_thumbnail_color,this.min_story_length=40,this.render()}render(){return HOME.ui.render(this.target,"module_popup",this,!0,t=>(this.parent=t,t.unbind().click(t=>this.hide()),t.find(".form").unbind().click(t=>t.stopPropagation()),"qr"===this.popup_type&&HOME.ui.qr_code(this.parent.find(".qr")[0],this.placeholder.qr_url,512),"login"===this.popup_type&&(t.find(".forgot_password").unbind().click(t=>(this.is_forgot_password=!0,this.render())),t.find(".switch").unbind().click(t=>(this.is_signup=parseInt($(t.target).attr("is_signup")),this.render()))),"edit_filter"===this.popup_type&&(this.max_tags_length=30,this.max_name_length=30,this.max_description_length=100,t.find(".input.tags input")[0].addEventListener("keyup",e=>{var i;if(!((i=$(e.target).val().length)>this.max_tags_length))return t.find(".input.tags .character_counter").text(`${i}/${this.max_tags_length} characters`);t.find(".input.tags input").text($(e.target).val().substr(0,this.max_tags_length-1))}),t.find(".input.name input")[0].addEventListener("keyup",e=>{var i;if(!((i=$(e.target).val().length)>this.max_name_length))return t.find(".input.name .character_counter").text(`${i}/${this.max_name_length} characters`);t.find(".input.name input").text($(e.target).val().substr(0,this.max_name_length-1))}),t.find(".input.description textarea")[0].addEventListener("keyup",e=>{var i;if(!((i=$(e.target).val().length)>this.max_description_length))return t.find(".input.description .character_counter").text(`${i}/${this.max_description_length} characters`);t.find(".input.description textarea").text($(e.target).val().substr(0,this.max_description_length-1))})),"submit"===this.popup_type&&(t.find(".input.story textarea")[0].addEventListener("keyup",e=>{var i;return(i=$(e.target).val().length)>this.min_story_length?t.find(".input.story .character_counter").empty():t.find(".input.story .character_counter").text(`need ${this.min_story_length-i} more characters.`)}),t.find(".avatar.file input")[0].addEventListener("change",e=>(t.find(".avatar.file .background_placeholder").css("background-image","none"),this.extract_photo(e.target.files[0],250,500,".avatar.file",(t,e,i)=>(this.user_avatar_placeholder=!1,this.file_submit_avatar=t,this.file_submit_avatar_exif=i)))),t.find(".photo.file input")[0].addEventListener("change",t=>(this.file_submit_photo=t.target.files[0],this.extract_photo(this.file_submit_photo,2048,1280,".photo.file",(t,e,i)=>{if(this.file_submit_thumbnail=t,this.file_submit_thumbnail_color=HOME.ui.rgb_hex(e),this.file_submit_photo_exif=i,this.file_submit_photo_exif.make&&this.file_submit_photo_exif.model)return this.parent.find(".input.gears input").val(`${this.file_submit_photo_exif.make} ${this.file_submit_photo_exif.model}`)})))),t.find(".form_action").unbind().click(e=>{var i,r,s,n,a,_;return this.subscribe?this.add_subscriber(t.find(".email input").val()):"qr"===this.popup_type?((i=document.createElement("a")).href=this.parent.find(".qr img")[0].src,i.download=`polarr_filter_${this.placeholder.qr_url.split("custom_filter/")[1]}.jpg`,i.click(),this.hide()):"rules"===this.popup_type?this.hide():"edit_filter"===this.popup_type?(this.parent.find(".error").text(""),_=t.find(".tags input").val(),a=t.find(".name input").val(),r=t.find(".demo_image input").val(),n=t.find(".is_public input").is(":checked"),s=t.find(".description textarea").val(),_&&s&&a&&validate_url(r)?(this.parent.find(".form_action").addClass("busy"),this.submit_callback({tags:_,name:a,description:s,demo_image:r,is_public:n})):this.parent.find(".error").text("Missing tag, name, demo image, or description.")):"submit"===this.popup_type?this.submit_photo():"login"===this.popup_type?this.is_forgot_password?this.reset_password(t.find(".email input").val()):this.is_signup?this.register(t.find(".user_name input").val(),t.find(".email input").val(),t.find(".password input").val()):this.login_manual(t.find(".email input").val(),t.find(".password input").val()):void 0}),HOME.ui.schedule(function(){return t.find(".email input").focus()}),t.find(".password input").on("keydown",e=>{if(13===e.which)return t.find(".form_action").click()})))}extract_photo(t,e,i,r,s){return EXIF.getData(t,function(){var n,a;return n={make:EXIF.getTag(this,"Make"),model:EXIF.getTag(this,"Model"),fnumbder:EXIF.getTag(this,"FNumber"),iso:EXIF.getTag(this,"ISOSpeedRatings"),exposure:EXIF.getTag(this,"ExposureTime"),orientation:EXIF.getTag(this,"Orientation")},(a=document.createElement("img")).src=URL.createObjectURL(t),a.onload=function(){var t,_,o,l,h,d;if(!(Math.max(a.height,a.width)<e)){for((t=document.createElement("canvas")).width=i,t.height=parseInt(t.width*a.height/a.width),t.getContext("2d").drawImage(a,0,0,t.width,t.height),h=-4,d={r:0,g:0,b:0},_=0,o=t.getContext("2d").getImageData(0,0,t.width,t.height);h<o.data.length-4;)h+=320,_+=1,d.r+=o.data[h],d.g+=o.data[h+1],d.b+=o.data[h+2];return d.r=Math.floor(d.r/_),d.g=Math.floor(d.g/_),d.b=Math.floor(d.b/_),r&&($(`${r} canvas`).remove(),$(r).prepend(t)),l=t.toDataURL("image/jpeg",.85),s(HOME.ws.dataURItoBlob(l),d,n)}alert(`The image has to be at least ${e} pixel wide.`)}})}submit_photo(){var t,e,i,r,s,n,a;for(a={},r=0,s=(i=["location","gears","author","contact","story","tags"]).length;r<s;r++){if(a[e=i[r]]=this.parent.find(`.${e} input`).val()||this.parent.find(`.${e} textarea`).val(),"contact"!==e&&!a[e])return this.parent.find(`.${e} input`).addClass("error"),void this.parent.find(`.${e} textarea`).addClass("error");if(this.parent.find(`.${e} input`).removeClass("error"),this.parent.find(`.${e} textarea`).removeClass("error"),"story"===e&&a[e]&&a[e].length<this.min_story_length)return this.parent.find(`.${e} input`).addClass("error"),void this.parent.find(`.${e} textarea`).addClass("error");if("contact"===e&&a[e]&&!HOME.ui.is_url(a[e]))return this.parent.find(`.${e} input`).addClass("error"),void alert("Please make sure you use an URL format for your social link.")}if(a.exif=this.file_submit_photo_exif,this.file_submit_thumbnail){if(this.file_submit_avatar||this.user_avatar_placeholder)return n=(new Date).toDateString().replace(RegExp(" ","g"),"_"),(t=new FormData).append("user_id",HOME.md.get_item("user_id")),t.append("tags",a.tags),delete a.tags,t.append("img_desc",JSON.stringify(a)),t.append("img_color",this.file_submit_thumbnail_color),t.append("image",this.file_submit_photo,`full_res_${n}.jpg|${HOME.ui.exif_orientation_to_degrees(this.file_submit_photo_exif.orientation)}`),this.user_avatar_placeholder?t.append("avatar_url",this.user_avatar_placeholder):t.append("avatar",this.file_submit_avatar,`avatar_${n}.jpg|${HOME.ui.exif_orientation_to_degrees(this.file_submit_avatar_exif.orientation)}`),this.parent.find(".form_action").remove(),this.parent.find(".form_inner").html("<div class='title'>Submitting, please do not close window..</div>"),"undefined"!=typeof NProgress&&null!==NProgress&&NProgress.start(),$.ajax({url:"/palette/add_img",data:t,contentType:!1,cache:!1,processData:!1,type:"POST",success:t=>("undefined"!=typeof NProgress&&null!==NProgress&&NProgress.done(),"success"===t.status?this.parent.find(".form_inner").html("<div class='title'>Submission successful！Please check your email.</div>"):this.parent.find(".form_inner").html("<div class='title'>Submission failed. Please contact support@polarr.co</div>"))});this.parent.find(".avatar.file").addClass("error")}else this.parent.find(".photo.file").addClass("error")}register(t,e,i){return this.parent.find(".error").text(""),this.parent.find(".form_action").addClass("busy"),HOME.ws.request("post","users/create",{user_name:t,email:e,password:i},t=>(this.parent.find(".form_action").removeClass("busy"),"error"===t.status?this.parent.find(".error").text(t.message):(this.user_signed_in=!0,this.hide())))}add_subscriber(t){if(this.parent.find(".error").text(""),validate_email(t))return this.parent.find(".form_action").addClass("busy"),HOME.ws.request("post","users/add_to_alpha",{email:t,product:"polayoutu"},t=>(this.parent.find(".form_action").hide(),this.parent.find(".form_inner .email").hide(),this.parent.find(".form_inner .title").text("Thank you for subscribing."),setTimeout(()=>this.hide(),2e3)));this.parent.find(".error").text("Wrong email format.")}reset_password(t){return this.parent.find(".error").text(""),this.parent.find(".form_action").addClass("busy"),HOME.ws.request("post","users/forget_password",{email:t,ignore_session:!0},t=>(this.parent.find(".form_action").removeClass("busy"),"error"===t.status?this.parent.find(".error").text("Your password doesn't exist."):(this.parent.find(".form_action").hide(),this.parent.find(".form_inner .email").hide(),this.parent.find(".form_inner .title").text("Please check your email."))))}login_manual(t,e){return this.parent.find(".error").text(""),this.parent.find(".form_action").addClass("busy"),HOME.ws.request("post","users/signin_email_pwd",{email:t,password:e,ignore_session:!0},t=>(this.parent.find(".form_action").removeClass("busy"),"error"===t.status?(this.user_signed_in=!1,this.parent.find(".error").text("Wrong email or password.")):this.iso_requirement&&t.data.account_karma<this.iso_requirement?(this.user_signed_in=!1,this.parent.find(".error").text(`You only have ${t.data.account_karma} ISO，but you need at least ${this.iso_requirement} ISO.`)):(this.user_signed_in=!0,this.user_id=t.data.user_id,this.user_name=t.data.user_name,this.hide(),"function"==typeof this.pass_through_callback?this.pass_through_callback():void 0)))}login_auto(t){return window.login_auto_triggered?"function"==typeof t?t():void 0:(window.login_auto_triggered=!0,HOME.md.get_item("session_token")&&HOME.md.get_item("user_id")?HOME.ws.request("post","users/signin_id_token",{},e=>"error"===e.status?(this.user_signed_in=!1,"function"==typeof t?t():void 0):(this.user_signed_in=!0,this.user_id=HOME.md.get_item("user_id"),this.user_name=HOME.md.get_item("user_name"),"function"==typeof t?t():void 0)):(this.user_signed_in=!1,"function"==typeof t?t():void 0))}check(t,e){return setTimeout(()=>(this.pass_through_callback=t,this.login_auto(()=>this.iso_requirement&&HOME.md.get_item("account_karma")<this.iso_requirement?this.show():this.user_signed_in?"function"==typeof this.pass_through_callback?this.pass_through_callback():void 0:("function"==typeof this.no_pass_callback&&this.no_pass_callback(),this.show()))))}hide(){return this.parent.hide()}show(){return this.hide_on_start=!1,this.parent.show()}},(UTIL=UTIL||{}).genid=function(){return Math.random().toString(36).substring(7)},VIEWER=class{constructor(t){var e,i,r,s,n;for(this.wrapper=document.createElement("div"),this.wrapper.className="wrapper",this.map_container=document.createElement("div"),this.map_container.className="map_container",this.fstops=document.createElement("div"),this.fstops.className="fstops",this.mms=document.createElement("div"),this.mms.className="mms",this.lens_name=document.createElement("div"),this.lens_name.className="lens_name",this.not_avail=document.createElement("div"),this.not_avail.className="not_avail",this.lens_name.innerHTML=t.lens.full_name+" MSRP:"+t.lens.msrp,this.id=t.id,this.image=t.image,this.lens=t.lens,this.cur_aperture=t.cur_aperture,this.avail_apertures=t.avail_apertures,this.current_f=null,this.current_m=null,r=0,s=(n=this.avail_apertures).length;r<s;r++)i=n[r],e=document.createElement("div"),i===this.cur_aperture?e.className="f active":e.className="f",e.innerHTML="f"+i/10,e.value=i,this.fstops.appendChild(e),e.addEventListener("click",e=>(t.onf(this.id,e.target.value),this.setf(e.target.value)));this.wrapper.appendChild(this.map_container),this.wrapper.appendChild(this.lens_name),this.wrapper.appendChild(this.not_avail),this.wrapper.appendChild(this.fstops),document.getElementById("comparison_views").appendChild(this.wrapper),this.map=L.map(this.map_container,{center:[0,0],zoom:0,dragging:!0,keyboard:!1,inertia:!1,zoomControl:!1,attributionControl:!1,boxZoom:!1,maxZoom:5,minZoom:0}),setTimeout(()=>this.map.setZoom(2),500),this.prev_x=null,this.prev_y=null,this.layer=L.tileLayer.zoomify(`https://s3-us-west-2.amazonaws.com/lensbattle/50mm/${this.image}/{g}/{z}-{x}-{y}.jpg`,{width:6016,height:4016,noWrap:!0,attribution:"&copy; Polarr Lens Project",crs:L.CRS.Simple,map:this.map}).addTo(this.map),this.map.fitBounds(this.layer.options.bounds),this.map.on("drag",e=>{var i,r;return i=e.originalEvent.pageX,r=e.originalEvent.pageY,this.prev_x&&t.ondrag(this.id,this.prev_x-i,this.prev_y-r),this.prev_x=i,this.prev_y=r}),this.map.on("dragend",t=>(this.prev_x=null,this.prev_y=null)),this.map.on("zoomend",e=>t.onzoom(this.id,this.map.getCenter(),this.map.getZoom()))}move(t,e){return this.map.panBy([t,e],{animate:!1})}zoom(t,e){return this.map.setZoom(e,{center:t})}setf(t){var e,i,r,s,n;for(n=[],i=0,r=(s=this.fstops.childNodes).length;i<r;i++)(e=s[i]).value===t?(0!==parseFloat(this.not_avail.style.opacity)?e.className="f active na":e.className="f active",n.push(this.current_f=t)):n.push(e.className="f");return n}setm(t){var e,i,r,s,n;for(n=[],e=0,i=(s=this.mms.childNodes).length;e<i;e++)(r=s[e]).value===t?(r.className="m active",n.push(this.current_m=t)):n.push(r.className="m");return n}set_image(t){return t?(this.not_avail.style.opacity=0,this.layer.setUrl(`https://s3-us-west-2.amazonaws.com/lensbattle/50mm/${t}/{g}/{z}-{x}-{y}.jpg`)):this.not_avail.style.opacity=.8}},load_lens_comparison=function(){var t,e,i,r,s,n,a,_,o,l,h,d,u,p,m,c,g,f,b;for(window.viewers=[],!0,d=!0,p=!0,i="car",18,e=null,h=[{name:"nikon5018D",full_name:"Nikon 50mm f/1.8D",msrp:"~$120"},{name:"nikon5018G",full_name:"Nikon 50mm f/1.8G AFS",msrp:"~$190"},{name:"nikon5014D",full_name:"Nikon 50mm f/1.4D",msrp:"~$320"},{name:"nikon5014G",full_name:"Nikon 50mm f/1.4G AFS",msrp:"~$490"},{name:"Sigma5014Art",full_name:"Sigma 50mm F1.4 DG HSM Art",msrp:"$930"},{name:"Zeiss5014",full_name:"Zeiss 50mm f/1.4 ZE Planar T*",msrp:"~$610"}],t=[14,18,20,28,40,56],_=["bear/14_500_800_Sigma5014Art","bear/14_500_800_Zeiss5014","bear/14_500_800_nikon5014D","bear/14_500_800_nikon5014G","bear/18_500_500_Sigma5014Art","bear/18_500_500_Zeiss5014","bear/18_500_500_nikon5014D","bear/18_500_500_nikon5014G","bear/18_500_500_nikon5018D","bear/18_500_500_nikon5018G","bear/20_500_320_Sigma5014Art","bear/20_500_320_Zeiss5014","bear/20_500_320_nikon5014D","bear/20_500_320_nikon5014G","bear/20_500_320_nikon5018D","bear/20_500_320_nikon5018G","bear/28_500_200_Sigma5014Art","bear/28_500_200_Zeiss5014","bear/28_500_200_nikon5014D","bear/28_500_200_nikon5014G","bear/28_500_200_nikon5018D","bear/28_500_200_nikon5018G","bear/40_500_100_Sigma5014Art","bear/40_500_100_Zeiss5014","bear/40_500_100_nikon5014D","bear/40_500_100_nikon5014G","bear/40_500_100_nikon5018D","bear/40_500_100_nikon5018G","bear/56_500_50_Sigma5014Art","bear/56_500_50_Zeiss5014","bear/56_500_50_nikon5014D","bear/56_500_50_nikon5014G","bear/56_500_50_nikon5018D","bear/56_500_50_nikon5018G","box/14_500_1000_Sigma5014Art","box/14_500_1000_Zeiss5014","box/14_500_1000_nikon5014D","box/14_500_1000_nikon5014G","box/18_500_640_Sigma5014Art","box/18_500_640_Zeiss5014","box/18_500_640_nikon5014D","box/18_500_640_nikon5014G","box/18_500_640_nikon5018D","box/18_500_640_nikon5018G","box/20_500_500_Sigma5014Art","box/20_500_500_Zeiss5014","box/20_500_500_nikon5014D","box/20_500_500_nikon5014G","box/20_500_500_nikon5018D","box/20_500_500_nikon5018G","box/28_500_250_Sigma5014Art","box/28_500_250_Zeiss5014","box/28_500_250_nikon5014D","box/28_500_250_nikon5014G","box/28_500_250_nikon5018D","box/28_500_250_nikon5018G","box/40_500_100_nikon5018D","box/40_500_125_Sigma5014Art","box/40_500_125_Zeiss5014","box/40_500_125_nikon5014D","box/40_500_125_nikon5014G","box/40_500_125_nikon5018G","box/56_500_59_Sigma5014Art","box/56_500_59_Zeiss5014","box/56_500_59_nikon5014D","box/56_500_59_nikon5014G","box/56_500_59_nikon5018D","box/56_500_59_nikon5018G","car/14_500_500_Sigma5014Art","car/14_500_500_Zeiss5014","car/14_500_500_nikon5014D","car/14_500_500_nikon5014G","car/18_500_400_Sigma5014Art","car/18_500_400_Zeiss5014","car/18_500_400_nikon5014D","car/18_500_400_nikon5014G","car/18_500_400_nikon5018D","car/18_500_400_nikon5018G","car/20_500_320_Sigma5014Art","car/20_500_320_Zeiss5014","car/20_500_320_nikon5014D","car/20_500_320_nikon5014G","car/20_500_320_nikon5018D","car/20_500_320_nikon5018G","car/28_500_160_Sigma5014Art","car/28_500_160_Zeiss5014","car/28_500_160_nikon5014D","car/28_500_160_nikon5014G","car/28_500_160_nikon5018D","car/28_500_160_nikon5018G","car/40_500_80_Sigma5014Art","car/40_500_80_Zeiss5014","car/40_500_80_nikon5014D","car/40_500_80_nikon5014G","car/40_500_80_nikon5018D","car/40_500_80_nikon5018G","car/56_500_40_Zeiss5014","car/56_500_40_nikon5014D","car/56_500_40_nikon5014G","car/56_500_40_nikon5018D","car/56_500_40_nikon5018G","car/56_500_40_Sigma5014Art","doll/14_500_4000_Sigma5014Art","doll/14_500_4000_Zeiss5014","doll/14_500_4000_nikon5014D","doll/14_500_4000_nikon5014G","doll/18_500_3200_Sigma5014Art","doll/18_500_4000_Zeiss5014","doll/18_500_4000_nikon5014D","doll/18_500_4000_nikon5014G","doll/18_500_4000_nikon5018D","doll/18_500_4000_nikon5018G","doll/20_500_2500_Sigma5014Art","doll/20_500_3200_Zeiss5014","doll/20_500_3200_nikon5014D","doll/20_500_3200_nikon5014G","doll/20_500_3200_nikon5018D","doll/20_500_3200_nikon5018G","doll/28_500_1250_Sigma5014Art","doll/28_500_1600_Zeiss5014","doll/28_500_1600_nikon5014D","doll/28_500_1600_nikon5014G","doll/28_500_1600_nikon5018D","doll/28_500_1600_nikon5018G","doll/40_500_640_Sigma5014Art","doll/40_500_800_Zeiss5014","doll/40_500_800_nikon5014D","doll/40_500_800_nikon5014G","doll/40_500_800_nikon5018D","doll/40_500_800_nikon5018G","doll/56_500_320_Sigma5014Art","doll/56_500_400_Zeiss5014","doll/56_500_400_nikon5014D","doll/56_500_400_nikon5014G","doll/56_500_400_nikon5018D","doll/56_500_400_nikon5018G","tiger/14_500_400_Sigma5014Art","tiger/14_500_400_Zeiss5014","tiger/14_500_400_nikon5014D","tiger/14_500_400_nikon5014G","tiger/18_500_320_Sigma5014Art","tiger/18_500_320_Zeiss5014","tiger/18_500_320_nikon5014D","tiger/18_500_320_nikon5014G","tiger/18_500_320_nikon5018D","tiger/18_500_320_nikon5018G","tiger/20_500_250_Sigma5014Art","tiger/20_500_250_Zeiss5014","tiger/20_500_250_nikon5014D","tiger/20_500_250_nikon5014G","tiger/20_500_250_nikon5018D","tiger/20_500_250_nikon5018G","tiger/28_500_125_Sigma5014Art","tiger/28_500_125_Zeiss5014","tiger/28_500_125_nikon5014D","tiger/28_500_125_nikon5014G","tiger/28_500_125_nikon5018D","tiger/28_500_125_nikon5018G","tiger/40_500_59_Sigma5014Art","tiger/40_500_59_Zeiss5014","tiger/40_500_59_nikon5014D","tiger/40_500_59_nikon5014G","tiger/40_500_59_nikon5018D","tiger/40_500_59_nikon5018G","tiger/56_500_30_Sigma5014Art","tiger/56_500_30_Zeiss5014","tiger/56_500_30_nikon5014D","tiger/56_500_30_nikon5014G","tiger/56_500_30_nikon5018D","tiger/56_500_30_nikon5018G"],u=document.getElementById("lockf"),m=document.getElementById("lockpan"),a=document.getElementById("image_sel"),u.addEventListener("change",function(t){return d=t.target.checked}),m.addEventListener("change",function(t){var i,r,s,n;if((p=t.target.checked)&&e){for(s=[],i=0,r=viewers.length;i<r;i++)n=viewers[i],s.push(n.zoom(e));return s}}),a.addEventListener("change",function(t){var e,r,n,a;for(i=t.target.value,n=[],e=0,r=viewers.length;e<r;e++)a=viewers[e],n.push(a.set_image(s(a.lens,18,i)));return n}),g=((t,e,i)=>{var r,s,n,a,_,o,l;if(p){for(_=[],r=0,n=viewers.length;r<n;r++)(l=viewers[r]).id!==t?_.push(l.move(e,i)):_.push(void 0);return _}for(o=[],s=0,a=viewers.length;s<a;s++)(l=viewers[s]).id===t?o.push(l.move(e,i)):o.push(void 0);return o}),b=((t,e,i)=>{var r,s,n,a;for(n=[],r=0,s=viewers.length;r<s;r++)(a=viewers[r]).id!==t?n.push(a.zoom(e,i)):n.push(void 0);return n}),r=((t,e)=>{var r,n,a,_,o,l,h;if(d){for(o=[],r=0,a=viewers.length;r<a;r++)(h=viewers[r]).set_image(s(h.lens,e,i)),h.id!==t?o.push(h.setf(e)):o.push(void 0);return o}for(l=[],n=0,_=viewers.length;n<_;n++)(h=viewers[n]).id===t?l.push(h.set_image(s(h.lens,e,i))):l.push(void 0);return l}),c=((t,e)=>{var i,r,s,n;for(s=[],i=0,r=viewers.length;i<r;i++)(n=viewers[i]).id!==t?s.push(n.setm(e)):s.push(void 0);return s}),s=((t,e,i)=>{var r,s,n,a,o;for(s=0,n=_.length;s<n;s++)if(o=(a=(r=_[s]).split("/"))[1].split("_"),a[0]===i&&parseInt(o[0])===parseInt(e)&&o[3]===t.name)return r;return!1}),f=[],o=0,l=h.length;o<l;o++)n=h[o],f.push(viewers.push(new VIEWER({id:UTIL.genid(),lens:n,cur_aperture:18,avail_apertures:t,image:s(n,18,i),ondrag:function(t,e,i){return g(t,e,i)},onzoom:function(t,i,r){return e=i,b(t,i,r)},onf:function(t,e){return r(t,e)},onm:function(t,e){return c(t,e)}})));return f},PAGE_PALETTE_INTRO=class{constructor(t){var e;t=t||{},({target:this.target}=t),this.parent,e=this,HOME.ui.render(this.target,"page_palette_intro",null,!1,t=>e.parent=t)}},PAGE_PALETTE=function(){return jQuery.fn.scrollTo=function(t){return $(this).animate({scrollTop:$(this).scrollTop()-$(this).offset().top+$(t).offset().top-.35*window.innerHeight},200)},class{constructor(t){t=t||{},({target:this.target}=t),this.parent,setTimeout(()=>(document.body.style.background="black",this.init()),0)}init(){var t,e,i,r,s,n,a,_,o,l,h,d,u,p;return o=0,l=(h={"#4e2d14":["borui 0016.jpg","borui 0018.jpg"],"#a7605c":["borui 0012.jpg","borui 0059.jpg"],"#b18f5e":["borui 0025.jpg","borui 0029.jpg"],"#5b6348":["borui 0011.jpg"],"#465d8b":["borui 0002.jpg","borui 0004.jpg"],"#18202b":["borui 0003.jpg","borui 0005.jpg"],"#bfc8cf":["borui 0001.jpg","borui 0006.jpg"]})[(s=["#4e2d14","#a7605c","#b18f5e","#5b6348","#465d8b","#18202b","#bfc8cf"])[r=0]],n=!0,_=!0,p=[],d=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},a=function(e){return $(".colorbtn").removeClass("color_selected"),$(".color_"+e).addClass("color_selected"),l=h[s[e]],o=d(0,l.length-1),t(l[o],o),i()},t=function(t,e){return clearTimeout(this.assign_image_timeout),$(".back_wrapper").text(""),$(".photobox .photo").css("opacity","0"),$("<img/>").attr("src","/images/small__"+t).load(function(){var i;if($(this).remove(),HOME.ui.find_dom_color("/images/small__"+t,{return_hex:!1},function(t){return $(".page_palette").css("background","rgba("+t.r+","+t.g+","+t.b+",0.6)")}),e)return $(".preview").removeClass("preview_selected"),(i=$(".previews").find(":nth-child("+(e+1)+")")).addClass("preview_selected"),$(".previews").scrollTo(i)}),$("<img/>").attr("src","/images/"+t).load(function(){return this.assign_image_timeout=setTimeout(()=>($(this).remove(),$(".photobox .photo").css("background-image","url('/images/"+t+"')"),$(".photobox .photo").attr("img_str",t),n?(u("about"),n=!1):($(".photobox .photo").css("opacity","1"),$(".aboutbtn").css("opacity","1"))),300)})},i=function(){var e,i;for(e="",i=0;i<l.length;)e+="<div class='preview_thumb_"+i+" preview pimg hide' style='background-image:url(\"/images/small__"+l[i]+"\")' img_str='"+l[i]+"'></div>",$("<img/>").attr({src:"/images/small__"+l[i],index:i}).load(function(){return $(".preview_thumb_"+$(this).attr("index")).css("opacity",.7),$(this).remove()}),i++;$(".previews").html(e),setTimeout(function(){$(".preview").unbind().click(function(){var e;e=$(this).attr("img_str"),o=l.indexOf(e),t(e,o)})},0)},e=function(){var t,e;for(t="",e=0;e<s.length;)t+="<div class='colorbtn color_"+e+"'  style='background:"+s[e]+"' index='"+e+"'></div>",e++;$(".colors").html(t),setTimeout(function(){$(".colorbtn").click(function(){r=$(this).attr("index"),a(r)})})},u=function(t){return $(".photobox .photo").css("opacity","0.05"),"about"===t?($(".aboutbtn").css("opacity","0"),$(".back_wrapper").html('Use the colors at the top to filter pictures. This album is built by Borui and includes his photos taken since 2009. He decided to use colors to index his photos rather than locations or types. To get in touch, contact bwang29@gmail.com : ).<br/><div class="arrow"><img src="/img/arrow_keys.png" /></div>')):"firstpage"===t?$(".back_wrapper").html('That was the last picture of this color. Try choosing another color.<br/><div class="arrow"><img src="/img/arrow_keys.png" /></div>'):"lastpage"===t?$(".back_wrapper").html('That was the last picture of this color. Try choosing another color.<br/><div class="arrow"><img src="/img/arrow_keys.png" /></div>'):void 0},window.classify_color=function(){var t,e,i,r;for(t={},e=0;e<s.length;)t[s[e]]=[],e++;for(i=99999,r="",e=0;e<p.length;)!function(){var n;n=e,HOME.ui.find_dom_color("/images/small__"+p[n],{return_hex:!0},function(e){var a,_;for(i=99999,a=0;a<s.length;)(_=HOME.ui.color_similarty(e,s[a]))<i&&(i=_,r=s[a]),a++;t[r].push(p[n])})}(),e++;setTimeout(function(){h=t},2e3)},$(document).ready(function(){return o=d(0,l.length-1),e(),a(r),$(".page_palette").click(function(){if(_)return t(l[o],o),_=!1}),$(".aboutbtn").click(function(t){return t.preventDefault(),t.stopPropagation(),u("about"),_=!0}),$(document).keydown(function(e){return 40===e.keyCode?o===l.length-1?u("lastpage"):t(l[++o],o):38===e.keyCode&&(0===o?u("firstpage"):t(l[--o],o)),39===e.keyCode?r===s.length-1||a(++r):37===e.keyCode&&(0===r||a(--r)),e.preventDefault(),e.stopPropagation()})})}}}.call(this);
/*!

Polarr.co Copyright 2019-12-11. All rights reserved.

No part of the materials including graphics, logos, designs, codes,
available in this Web site may be copied, photocopied, reproduced, translated or
reduced to any electronic medium or machine-readable form, in whole or in part,
without specific permission. Distribution for commercial purposes is prohibited.

 ...............................................................................
................................................................................
.......................................M........................................
.......................................M........................................
.......................................M........................................
...............  .. .......... ........M......   .  .........   ...  ...........
............MM ... MN .....MM....MM ...M... MM....OM..... :M?...MM..............
.......... M........,M ..DM .......M ..M.. M........MM...M7....M................
..........M..........MD. M..........M..M..M .........M.. M....M:..... ... ... ..
..........M ......... M. M..........M..M. M .........$M.M.....M.................
..........M..........M8. M..........M..M..M .........MM.M.....M.................
..........MM........ M...NM,.......M ..M.. M........NMM.M.....M.................
..........M.NM....~MZ......MM ...MM ...M....MM.. .8M $M.M.....M.................
..........M...... ...........  ................,  ......  ......................
..........M.....................................................................
..........M.....................................................................
.. .......M.......................................................... ... ... ..
................................................................................

polarr_homepage_v1 2019-12-11

*/

var HOME,validate_email,validate_url;validate_email=function(t){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t)},validate_url=function(t){return/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(t)},(HOME=HOME||{}).reserved_route_names=[""],HOME.init_home_page=function(){return $(document).ready(function(){var t,e;return e=["Infinite Photo Journey","Used by 10M Photographers","Two-time Best of Apple App Store since 2016"],t=0,setInterval(()=>(t+=1,$(".welcome").css("opacity","0"),setTimeout(()=>$(".welcome").css("opacity","1").text(e[t%3]),1e3)),5e3)})},HOME.rt=Davis(function(){return this.configure(function(){return this.generateRequestOnPageLoad=!0}),this.get("/",function(t){return HOME.init_home_page()}),this.get("/editor/:variant",function(t){return HOME.init_home_page()}),this.get("/palette",function(t){return HOME.palette_intro=new PAGE_PALETTE_INTRO}),this.get("/palette/:user_name",function(t){return HOME.palette=new PAGE_PALETTE}),this.get("/lens/:mm",function(t){return load_lens_comparison()})}),HOME.rt.route_to=((t,e)=>{if(Davis.location.assign(t),e)return location.reload()}),HOME.rt.refresh=(()=>Davis.location.assign(Davis.location.current())),HOME.rt.url=(()=>Davis.history.current()),HOME.rt.bind("runRoute",function(t){}).bind("routeNotFound",function(t){return console}).bind("start",function(){if(HOME.rt.logger.info("Polarr Home Started"),HOME.ui.is_browser_unsupported())return console}).bind("stop",function(){return HOME.rt.logger.info("Polarr Home stopped")}),HOME.rt.start();